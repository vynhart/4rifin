<!DOCTYPE html>
<html lang="en">
<head><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-28846418-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-28846418-3');
</script>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link href="https://fonts.googleapis.com/css?family=Merriweather:300|Raleway:400,700" rel="stylesheet">
<link rel="stylesheet" href="/assets/css/style.css">
<title>Authentication in Laravel</title>
<!-- Begin Jekyll SEO tag v2.1.0 -->
<title>Authentication in Laravel - Vin’s Blog</title>
<meta property="og:title" content="Authentication in Laravel" />
<meta name="description" content="Authentication in laravel is done in many ways, here is some of the possible way to do the authentication:" />
<meta property="og:description" content="Authentication in laravel is done in many ways, here is some of the possible way to do the authentication:" />
<link rel="canonical" href="/authentication-in-laravel/" />
<meta property="og:url" content="/authentication-in-laravel/" />
<meta property="og:site_name" content="Vin’s Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-05-09T19:00:00+07:00" />
<script type="application/ld+json">
{"@context": "http://schema.org",
"@type": "BlogPosting",
"headline": "Authentication in Laravel",
"datePublished": "2020-05-09T19:00:00+07:00",
"description": "Authentication in laravel is done in many ways, here is some of the possible way to do the authentication:",
"url": "/authentication-in-laravel/"}</script>
<!-- End Jekyll SEO tag -->

</head>
<body>
	<main class="container">
		<section class="about">
			<img src="/assets/portfolio.png" alt="Arifin">
			<h2>Arifin</h2>
			<p class="tagline">Software Engineer</p>
			<ul class="social"><a href="https://github.com/vynhart"><li><i class="icon-github-circled"></i></li></a><a href="https://www.linkedin.com/in/vynhart"><li><i class="icon-linkedin-squared"></i></li></a><a href="https://twitter.com/vynhart"><li><i class="icon-twitter-squared"></i></li></a></ul>
			<p>&copy; 2019</p>
		</section>
		<section class="content">
			<div class="post-container">
  <a class="post-link" href="/authentication-in-laravel/">
    <h2 class="post-title">Authentication in Laravel</h2>
  </a>
  <div class="post-meta">
    <ul class="post-categories"><li>laravel</li></ul>
    <div class="post-date"><i class="icon-calendar"></i>May 9, 2020</div>
  </div>
  <div class="post">
    <p>Authentication in laravel is done in many ways, here is some of the possible way to do the authentication:</p>

<h1 id="authentication-in-controller">Authentication in Controller</h1>

<p>The most common method of doing the authentication will probably by handles it via controller. To do that, the first thing you need to do is to add the <code class="highlighter-rouge">auth</code> middleware into controller’s constructor. for example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class AddressController extends Controller
{
    public function __construct() {
        $this-&gt;middleware('auth');
    }
    
    .....
</code></pre></div></div>

<p>by doing this, any non-logged in access into your controller will automatically be redirected to login page.</p>

<h1 id="conditional-authorization">Conditional Authorization</h1>

<p>In the real world, you will want to restrict access to resources so that it can only be accessed to users that’s owned it. For example, address A should be available to be accessed by user X.</p>

<p>Laravel serves several ways to enable this authorization</p>

<h2 id="authorize-user-in-controllers-method">Authorize user in controller’s method</h2>

<p>To do the authorization checking directly in controller’s method, you can do this simply by using laravel <code class="highlighter-rouge">abort</code> helper.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    public function show(Address $address)
    {
        if($address-&gt;owner_id !== auth()-user_id()) {
            abort(403);
        }
        
        // your logic
    }
</code></pre></div></div>

<p>or, using <code class="highlighter-rouge">abort_if</code></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    public function show(Address $address)
    {
        abort_if($address-&gt;owner_id !== auth()-user_id());
        
        // your logic
    }
</code></pre></div></div>

<h2 id="authorize-user-via-policy">Authorize user via policy</h2>

<p>Another method you can use to specify authorization is via policy. To do that, you can make a new policy that’s corresponding to certain model. For example, if you want to specify policy to <code class="highlighter-rouge">Address</code> model, then you can make it via php artisan command:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>php artisan make:policy AddressPolicy --model Address
</code></pre></div></div>

<p>by running that command now you should have a new file in <code class="highlighter-rouge">App/Policies/AddressPolicy.php</code> with a predefined methods. Here is the content of the file should looked like:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>

<span class="kn">namespace</span> <span class="nn">App\Policies</span><span class="p">;</span>

<span class="kn">use</span> <span class="nn">App\User</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">App\Address</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">Illuminate\Auth\Access\HandlesAuthorization</span><span class="p">;</span>

<span class="kd">class</span> <span class="nc">AddressPolicy</span>
<span class="p">{</span>
    <span class="o">.....</span>
</code></pre></div></div>

<p>In that file you’re supposed to see all the functions with similar name with the function in your controller. This is intended as you’re expected to have a unique policy for each of your controller’s function.</p>

<p>For example, to give an authorization check in edit method of your AddressController, so that the Address that can be edited is only the Address that’s owned by the corresponding user, you can do this.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class AddressPolicy
{
    public function edit(User $user, Address $address)
    {
        return $address-&gt;owner_id === $user-&gt;id
    }
</code></pre></div></div>

<p>and then, in your AddressController now you can use the <code class="highlighter-rouge">authorize</code> method like following:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class AddressController
{
    .....
    
    public function edit(Address $address)
    {
        $this-&gt;authorize('edit', $address);
    }
}
</code></pre></div></div>

<p>The <code class="highlighter-rouge">authorize('edit', $address')</code> means that you use the <code class="highlighter-rouge">edit</code> method in your AddressPolicy (determined by $address variable you passed in the second parameter) to determine if user can access this particular address or not.</p>

  </div></div>

		</section>
	</main>
</body>
</html>
